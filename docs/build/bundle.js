var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function s(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,t){e.appendChild(t)}function r(e,t,n){e.insertBefore(t,n||null)}function i(e){e.parentNode.removeChild(e)}function a(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function h(){return f("")}function p(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t,n){const o=new Set;for(let t=0;t<e.length;t+=1)e[t].checked&&o.add(e[t].__value);return n||o.delete(t),Array.from(o)}function v(e){return""===e?null:+e}function x(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function _(e,t){e.value=null==t?"":t}function b(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let $;function y(e){$=e}function w(e){(function(){if(!$)throw new Error("Function called outside component initialization");return $})().$$.on_mount.push(e)}const k=[],j=[],S=[],O=[],E=Promise.resolve();let N=!1;function B(e){S.push(e)}const C=new Set;let L=0;function M(){const e=$;do{for(;L<k.length;){const e=k[L];L++,y(e),q(e.$$)}for(y(null),k.length=0,L=0;j.length;)j.pop()();for(let e=0;e<S.length;e+=1){const t=S[e];C.has(t)||(C.add(t),t())}S.length=0}while(k.length);for(;O.length;)O.pop()();N=!1,C.clear(),y(e)}function q(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}const U=new Set;function F(e,t){e&&e.i&&(U.delete(e),e.i(t))}function P(e,t){e.d(1),t.delete(e.key)}function A(e,t){-1===e.$$.dirty[0]&&(k.push(e),N||(N=!0,E.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function T(c,l,r,a,u,f,d,h=[-1]){const p=$;y(c);const m=c.$$={fragment:null,ctx:null,props:f,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(p?p.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:l.target||p.$$.root};d&&d(m.root);let g=!1;if(m.ctx=r?r(c,l.props||{},((e,t,...n)=>{const o=n.length?n[0]:t;return m.ctx&&u(m.ctx[e],m.ctx[e]=o)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](o),g&&A(c,e)),t})):[],m.update(),g=!0,o(m.before_update),m.fragment=!!a&&a(m.ctx),l.target){if(l.hydrate){const e=function(e){return Array.from(e.childNodes)}(l.target);m.fragment&&m.fragment.l(e),e.forEach(i)}else m.fragment&&m.fragment.c();l.intro&&F(c.$$.fragment),function(e,n,c,l){const{fragment:r,on_mount:i,on_destroy:a,after_update:u}=e.$$;r&&r.m(n,c),l||B((()=>{const n=i.map(t).filter(s);a?a.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(B)}(c,l.target,l.anchor,l.customElement),M()}y(p)}const I=e=>t=>({...t,pairs:t.path.map(((n,o)=>{const s=t.path[t.path[o+1]?o+1:0];return e[n]&&e[n].includes(s)?{base:s,quote:n,side:"BUY"}:e[s]&&e[s].includes(n)?{base:n,quote:s,side:"SELL"}:null})).map((e=>e?{...e,get id(){return`${this.base}${this.quote}`},get tickerName(){return`${this.id.toLowerCase()}@bookTicker`}}:null))});let Y;const J=()=>(Y=Y||new window.ccxt.binance,Y.loadMarkets()).then((e=>Object.values(e).reduce(((e,t,n)=>t.active&&t.spot?(e[t.quote]?e[t.quote].push(t.base):e[t.quote]=[t.base],e):e),{}))).then((e=>Object.entries(e).reduce(((t,[n,o])=>(t[n]=o.filter((o=>!!t[o]||Object.entries(e).some((([e,t])=>e!==n&&t.includes(o))))),t)),{}))),R=e=>JSON.stringify({method:"SUBSCRIBE",params:e,id:1});function z(e,t,n){const o=e.slice();return o[20]=t[n],o}function Q(e,t,n){const o=e.slice();return o[23]=t[n],o}function W(e,t,n){const o=e.slice();return o[23]=t[n],o}function D(e){let t,n,s,c,a,h,g,v,_=e[23]+"";return{c(){t=u("label"),n=u("input"),c=d(),a=f(_),h=d(),m(n,"type","checkbox"),n.__value=s=e[23],n.value=n.__value,e[10][0].push(n),m(t,"class","w-24")},m(o,s){r(o,t,s),l(t,n),n.checked=~e[1].indexOf(n.__value),l(t,c),l(t,a),l(t,h),g||(v=[p(n,"change",e[9]),p(n,"change",e[7])],g=!0)},p(e,t){4&t&&s!==(s=e[23])&&(n.__value=s,n.value=n.__value),2&t&&(n.checked=~e[1].indexOf(n.__value)),4&t&&_!==(_=e[23]+"")&&x(a,_)},d(s){s&&i(t),e[10][0].splice(e[10][0].indexOf(n),1),g=!1,o(v)}}}function G(e){let t,n,s,c,a,h,g,v,_=e[23]+"";return{c(){t=u("label"),n=u("input"),c=d(),a=f(_),h=d(),m(n,"type","checkbox"),n.__value=s=e[23],n.value=n.__value,e[10][0].push(n),m(t,"class","w-24")},m(o,s){r(o,t,s),l(t,n),n.checked=~e[1].indexOf(n.__value),l(t,c),l(t,a),l(t,h),g||(v=[p(n,"change",e[11]),p(n,"change",e[7])],g=!0)},p(e,t){8&t&&s!==(s=e[23])&&(n.__value=s,n.value=n.__value),2&t&&(n.checked=~e[1].indexOf(n.__value)),8&t&&_!==(_=e[23]+"")&&x(a,_)},d(s){s&&i(t),e[10][0].splice(e[10][0].indexOf(n),1),g=!1,o(v)}}}function H(e){let t,n,o,s,c,a,h,p,g,v,_=e[20].percent.toFixed(4)+"",$=e[20].joined+"";return{c(){t=u("div"),n=u("span"),o=f(_),s=f("%"),c=d(),a=u("div"),h=d(),p=u("span"),g=f($),v=d(),m(n,"class","w-20 font-bold font-mono flex justify-end"),b(n,"color",e[20].isProfitable?"green":"red"),m(a,"class","w-1"),m(p,"class","w-40"),m(t,"class","flex")},m(e,i){r(e,t,i),l(t,n),l(n,o),l(n,s),l(t,c),l(t,a),l(t,h),l(t,p),l(p,g),l(t,v)},p(e,t){16&t&&_!==(_=e[20].percent.toFixed(4)+"")&&x(o,_),16&t&&b(n,"color",e[20].isProfitable?"green":"red"),16&t&&$!==($=e[20].joined+"")&&x(g,$)},d(e){e&&i(t)}}}function K(e,t){let n,o,s=!isNaN(t[20].percent)&&isFinite(t[20].percent),c=s&&H(t);return{key:e,first:null,c(){n=h(),c&&c.c(),o=h(),this.first=n},m(e,t){r(e,n,t),c&&c.m(e,t),r(e,o,t)},p(e,n){t=e,16&n&&(s=!isNaN(t[20].percent)&&isFinite(t[20].percent)),s?c?c.p(t,n):(c=H(t),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(e){e&&i(n),c&&c.d(e),e&&i(o)}}}function V(t){let n,s,c,h,g,$,y,w,k,j,S,O,E,N,B,C,L,M,q,U,A,T,I,Y,J,R,H,V,X,Z,ee,te,ne,oe,se,ce,le,re,ie,ae,ue,fe,de,he,pe,me,ge,ve,xe,_e,be,$e,ye,we=t[0]/1e4+"",ke=[],je=new Map,Se=t[2],Oe=[];for(let e=0;e<Se.length;e+=1)Oe[e]=D(W(t,Se,e));let Ee=t[3],Ne=[];for(let e=0;e<Ee.length;e+=1)Ne[e]=G(Q(t,Ee,e));let Be=t[4];const Ce=e=>e[20].joined;for(let e=0;e<Be.length;e+=1){let n=z(t,Be,e),o=Ce(n);je.set(o,ke[e]=K(o,n))}return{c(){n=u("div"),s=d(),c=u("div"),h=u("h1"),g=f("Binance "),$=u("span"),y=f("â–²"),w=f(" Triangular arbitrage monitor"),k=d(),j=u("div"),S=d(),O=u("div"),E=u("div"),N=u("div"),B=u("span"),B.textContent="FEES",C=d(),L=u("div"),M=d(),q=u("input"),U=d(),A=u("div"),T=d(),I=u("span"),Y=f(we),J=f("%"),R=d(),H=u("div"),V=d(),X=u("div"),Z=u("div"),ee=u("div"),te=u("div"),te.textContent="Quote Currencies",ne=d(),oe=u("div");for(let e=0;e<Oe.length;e+=1)Oe[e].c();se=d(),ce=u("div"),le=d(),re=u("div"),ie=u("div"),ie.textContent="Base Currencies",ae=d(),ue=u("div");for(let e=0;e<Ne.length;e+=1)Ne[e].c();fe=d(),de=u("div"),he=d(),pe=u("div"),me=u("div"),ge=u("div"),ge.textContent="Paths",ve=d(),xe=u("div");for(let e=0;e<ke.length;e+=1)ke[e].c();_e=d(),be=u("div"),m(n,"class","h-4"),b($,"color",t[5]),m(h,"class","text-2xl"),m(c,"class","flex justify-center items-center"),m(j,"class","h-4"),m(L,"class","w-4"),m(q,"type","number"),m(A,"class","w-4"),m(N,"class","flex items-center"),m(E,"class","p-4 shadow"),m(O,"class","flex justify-center items-center"),m(H,"class","h-4"),m(te,"class","text-xl"),m(oe,"class","flex flex-wrap"),m(ee,"class","p-4 shadow"),m(ce,"class","h-4"),m(ie,"class","text-xl"),m(ue,"class","flex flex-wrap select"),m(re,"class","p-4 shadow"),m(Z,"class","w-1/3"),m(de,"class","w-4"),m(ge,"class","text-xl flex justify-center"),m(xe,"class","flex flex-wrap justify-center"),m(me,"class","p-4 shadow"),m(pe,"class","w-2/3"),m(X,"class","w-full flex"),m(be,"class","h-4")},m(e,o){r(e,n,o),r(e,s,o),r(e,c,o),l(c,h),l(h,g),l(h,$),l($,y),l(h,w),r(e,k,o),r(e,j,o),r(e,S,o),r(e,O,o),l(O,E),l(E,N),l(N,B),l(N,C),l(N,L),l(N,M),l(N,q),_(q,t[0]),l(N,U),l(N,A),l(N,T),l(N,I),l(I,Y),l(I,J),r(e,R,o),r(e,H,o),r(e,V,o),r(e,X,o),l(X,Z),l(Z,ee),l(ee,te),l(ee,ne),l(ee,oe);for(let e=0;e<Oe.length;e+=1)Oe[e].m(oe,null);l(Z,se),l(Z,ce),l(Z,le),l(Z,re),l(re,ie),l(re,ae),l(re,ue);for(let e=0;e<Ne.length;e+=1)Ne[e].m(ue,null);l(X,fe),l(X,de),l(X,he),l(X,pe),l(pe,me),l(me,ge),l(me,ve),l(me,xe);for(let e=0;e<ke.length;e+=1)ke[e].m(xe,null);r(e,_e,o),r(e,be,o),$e||(ye=[p(q,"input",t[8]),p(q,"keyup",t[6])],$e=!0)},p(e,[t]){if(32&t&&b($,"color",e[5]),1&t&&v(q.value)!==e[0]&&_(q,e[0]),1&t&&we!==(we=e[0]/1e4+"")&&x(Y,we),134&t){let n;for(Se=e[2],n=0;n<Se.length;n+=1){const o=W(e,Se,n);Oe[n]?Oe[n].p(o,t):(Oe[n]=D(o),Oe[n].c(),Oe[n].m(oe,null))}for(;n<Oe.length;n+=1)Oe[n].d(1);Oe.length=Se.length}if(138&t){let n;for(Ee=e[3],n=0;n<Ee.length;n+=1){const o=Q(e,Ee,n);Ne[n]?Ne[n].p(o,t):(Ne[n]=G(o),Ne[n].c(),Ne[n].m(ue,null))}for(;n<Ne.length;n+=1)Ne[n].d(1);Ne.length=Ee.length}16&t&&(Be=e[4],ke=function(e,t,n,o,s,c,l,r,i,a,u,f){let d=e.length,h=c.length,p=d;const m={};for(;p--;)m[e[p].key]=p;const g=[],v=new Map,x=new Map;for(p=h;p--;){const e=f(s,c,p),r=n(e);let i=l.get(r);i?o&&i.p(e,t):(i=a(r,e),i.c()),v.set(r,g[p]=i),r in m&&x.set(r,Math.abs(p-m[r]))}const _=new Set,b=new Set;function $(e){F(e,1),e.m(r,u),l.set(e.key,e),u=e.first,h--}for(;d&&h;){const t=g[h-1],n=e[d-1],o=t.key,s=n.key;t===n?(u=t.first,d--,h--):v.has(s)?!l.has(o)||_.has(o)?$(t):b.has(s)?d--:x.get(o)>x.get(s)?(b.add(o),$(t)):(_.add(s),d--):(i(n,l),d--)}for(;d--;){const t=e[d];v.has(t.key)||i(t,l)}for(;h;)$(g[h-1]);return g}(ke,t,Ce,1,e,Be,je,xe,P,K,null,z))},i:e,o:e,d(e){e&&i(n),e&&i(s),e&&i(c),e&&i(k),e&&i(j),e&&i(S),e&&i(O),e&&i(R),e&&i(H),e&&i(V),e&&i(X),a(Oe,e),a(Ne,e);for(let e=0;e<ke.length;e+=1)ke[e].d();e&&i(_e),e&&i(be),$e=!1,o(ye)}}}function X(e,t,n){let o,s,c=750,l=[],r=[],i=[],a=[],u={},f={},d=[],h="red";function p(){o=new WebSocket("wss://stream.binance.com/stream"),o.onopen=()=>{n(5,h="green"),s=setInterval(x,1e3),d.length>0&&o.send(R(d))},o.onmessage=e=>{const t=JSON.parse(e.data);if(null==t?void 0:t.data){const{s:e,a:n,b:o}=t.data;u[e]={BUY:n,SELL:o}}_()},o.onclose=()=>{n(5,h="red"),clearInterval(s),setTimeout((()=>{n(5,h="yellow"),p()}),1e3)}}function m(e){const t=[...new Set(e.flatMap((e=>e.pairs.map((e=>e.tickerName)))))];let n=t.filter((e=>!d.includes(e)));n.length>0&&(o.send(R(n)),d=[...d,...n]);let s=d.filter((e=>!t.includes(e)));var c;s.length>0&&(o.send((c=s,JSON.stringify({method:"UNSUBSCRIBE",params:c,id:312}))),d=d.filter((e=>!s.includes(e))))}function x(){n(4,a=a.sort(((e,t)=>t.percent-e.percent)))}function _(e=a){n(4,a=e.map(((e,t)=>n=>{const o=(t||0)/1e6,s=n.pairs.reduce(((t,n)=>{if("BUY"===n.side)return(t-t*o)/(e[n.id]?.BUY||0);const s=t*(e[n.id]?.SELL||1/0);return s-s*o}),1)-1;return{...n,percent:s/Math.abs(1)*100,isProfitable:s>0}})(u,c)))}w((()=>{J().then((e=>{f=e,n(2,r=Object.keys(e)),n(3,i=[...new Set(Object.values(e).flat(1))].filter((t=>!Object.keys(e).includes(t))))})),p()}));const b=[[]];return[c,l,r,i,a,h,_,function(){const e=(t=l,t.map((e=>t.map((n=>t.map((t=>e!==n&&e!==t&&n!==t?{path:[e,n,t],joined:`${e}/${n}/${t}`}:null)))))).flat(2).filter(Boolean).reduce(((e,t)=>{const{path:n}=t,o=e.map((e=>e.path.join()));return o.includes(n.join())||o.includes([n[1],n[2],n[0]].join())||o.includes([n[2],n[0],n[1]].join())||e.push(t),e}),[])).map(I(f)).filter((e=>e.pairs.every(Boolean)));var t;m(e),_(e)},function(){c=v(this.value),n(0,c)},function(){l=g(b[0],this.__value,this.checked),n(1,l)},b,function(){l=g(b[0],this.__value,this.checked),n(1,l)}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),T(this,e,X,V,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
