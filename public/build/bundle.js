var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function s(e){e.parentNode.removeChild(e)}function a(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function u(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function h(){return f("")}function p(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t,n){const o=new Set;for(let t=0;t<e.length;t+=1)e[t].checked&&o.add(e[t].__value);return n||o.delete(t),Array.from(o)}function v(e){return""===e?null:+e}function b(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function _(e,t){e.value=null==t?"":t}function $(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let y;function w(e){y=e}function x(e){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(e)}const k=[],S=[],E=[],O=[],j=Promise.resolve();let N=!1;function B(e){E.push(e)}const L=new Set;let M=0;function q(){const e=y;do{for(;M<k.length;){const e=k[M];M++,w(e),U(e.$$)}for(w(null),k.length=0,M=0;S.length;)S.pop()();for(let e=0;e<E.length;e+=1){const t=E[e];L.has(t)||(L.add(t),t())}E.length=0}while(k.length);for(;O.length;)O.pop()();N=!1,L.clear(),w(e)}function U(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}const C=new Set;function F(e,t){e&&e.i&&(C.delete(e),e.i(t))}function A(e,t){e.d(1),t.delete(e.key)}function P(e,t){-1===e.$$.dirty[0]&&(k.push(e),N||(N=!0,j.then(q)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function T(i,c,l,a,u,f,d,h=[-1]){const p=y;w(i);const m=i.$$={fragment:null,ctx:null,props:f,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(p?p.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:c.target||p.$$.root};d&&d(m.root);let g=!1;if(m.ctx=l?l(i,c.props||{},((e,t,...n)=>{const o=n.length?n[0]:t;return m.ctx&&u(m.ctx[e],m.ctx[e]=o)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](o),g&&P(i,e)),t})):[],m.update(),g=!0,o(m.before_update),m.fragment=!!a&&a(m.ctx),c.target){if(c.hydrate){const e=function(e){return Array.from(e.childNodes)}(c.target);m.fragment&&m.fragment.l(e),e.forEach(s)}else m.fragment&&m.fragment.c();c.intro&&F(i.$$.fragment),function(e,n,i,c){const{fragment:l,on_mount:s,on_destroy:a,after_update:u}=e.$$;l&&l.m(n,i),c||B((()=>{const n=s.map(t).filter(r);a?a.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(B)}(i,c.target,c.anchor,c.customElement),q()}w(p)}const I=e=>t=>({...t,pairs:t.path.map(((n,o)=>{const r=t.path[t.path[o+1]?o+1:0];return e[n]&&e[n].includes(r)?{base:r,quote:n,side:"BUY"}:e[r]&&e[r].includes(n)?{base:n,quote:r,side:"SELL"}:null})).map((e=>e?{...e,get id(){return`${this.base}${this.quote}`},get tickerName(){return`${this.id.toLowerCase()}@bookTicker`}}:null))});let Y;const J=()=>(Y=Y||new window.ccxt.binance,Y.loadMarkets()).then((e=>Object.values(e).reduce(((e,t,n)=>t.active&&t.spot?(e[t.quote]?e[t.quote].push(t.base):e[t.quote]=[t.base],e):e),{}))).then((e=>Object.entries(e).reduce(((t,[n,o])=>(t[n]=o.filter((o=>!!t[o]||Object.entries(e).some((([e,t])=>e!==n&&t.includes(o))))),t)),{}))),R=e=>JSON.stringify({method:"SUBSCRIBE",params:e,id:1});function z(e,t,n){const o=e.slice();return o[20]=t[n],o}function W(e,t,n){const o=e.slice();return o[23]=t[n],o}function D(e,t,n){const o=e.slice();return o[23]=t[n],o}function G(e){let t,n,r,i,a,h,g,v,_=e[23]+"";return{c(){t=u("label"),n=u("input"),i=d(),a=f(_),h=d(),m(n,"type","checkbox"),n.__value=r=e[23],n.value=n.__value,e[10][0].push(n),m(t,"class","svelte-io86af")},m(o,r){l(o,t,r),c(t,n),n.checked=~e[1].indexOf(n.__value),c(t,i),c(t,a),c(t,h),g||(v=[p(n,"change",e[9]),p(n,"change",e[7])],g=!0)},p(e,t){4&t&&r!==(r=e[23])&&(n.__value=r,n.value=n.__value),2&t&&(n.checked=~e[1].indexOf(n.__value)),4&t&&_!==(_=e[23]+"")&&b(a,_)},d(r){r&&s(t),e[10][0].splice(e[10][0].indexOf(n),1),g=!1,o(v)}}}function H(e){let t,n,r,i,a,h,g,v,_=e[23]+"";return{c(){t=u("label"),n=u("input"),i=d(),a=f(_),h=d(),m(n,"type","checkbox"),n.__value=r=e[23],n.value=n.__value,e[10][0].push(n),m(t,"class","svelte-io86af")},m(o,r){l(o,t,r),c(t,n),n.checked=~e[1].indexOf(n.__value),c(t,i),c(t,a),c(t,h),g||(v=[p(n,"change",e[11]),p(n,"change",e[7])],g=!0)},p(e,t){8&t&&r!==(r=e[23])&&(n.__value=r,n.value=n.__value),2&t&&(n.checked=~e[1].indexOf(n.__value)),8&t&&_!==(_=e[23]+"")&&b(a,_)},d(r){r&&s(t),e[10][0].splice(e[10][0].indexOf(n),1),g=!1,o(v)}}}function K(e){let t,n,o,r,i,a,h,p,m=e[20].percent.toFixed(4)+"",g=e[20].joined+"";return{c(){t=u("div"),n=u("span"),o=f(m),r=f("%"),i=d(),a=u("span"),h=f(g),p=d(),$(n,"width","5rem"),$(n,"font-weight","bold"),$(n,"color",e[20].isProfitable?"green":"red"),$(a,"width","10rem"),$(t,"display","flex")},m(e,s){l(e,t,s),c(t,n),c(n,o),c(n,r),c(t,i),c(t,a),c(a,h),c(t,p)},p(e,t){16&t&&m!==(m=e[20].percent.toFixed(4)+"")&&b(o,m),16&t&&$(n,"color",e[20].isProfitable?"green":"red"),16&t&&g!==(g=e[20].joined+"")&&b(h,g)},d(e){e&&s(t)}}}function Q(e,t){let n,o,r=!isNaN(t[20].percent)&&isFinite(t[20].percent),i=r&&K(t);return{key:e,first:null,c(){n=h(),i&&i.c(),o=h(),this.first=n},m(e,t){l(e,n,t),i&&i.m(e,t),l(e,o,t)},p(e,n){t=e,16&n&&(r=!isNaN(t[20].percent)&&isFinite(t[20].percent)),r?i?i.p(t,n):(i=K(t),i.c(),i.m(o.parentNode,o)):i&&(i.d(1),i=null)},d(e){e&&s(n),i&&i.d(e),e&&s(o)}}}function V(t){let n,r,i,h,g,y,w,x,k,S,E,O,j,N,B,L,M,q,U,C,P,T,I,Y,J,R,K,V,X,Z,ee,te,ne,oe,re,ie=t[0]/1e4+"",ce=[],le=new Map,se=t[2],ae=[];for(let e=0;e<se.length;e+=1)ae[e]=G(D(t,se,e));let ue=t[3],fe=[];for(let e=0;e<ue.length;e+=1)fe[e]=H(W(t,ue,e));let de=t[4];const he=e=>e[20].joined;for(let e=0;e<de.length;e+=1){let n=z(t,de,e),o=he(n);le.set(o,ce[e]=Q(o,n))}return{c(){n=u("div"),r=u("h1"),i=f("Binance "),h=u("span"),g=f("â–²"),y=f(" Triangular\r\n    arbitrage monitor"),w=d(),x=u("div"),k=u("div"),S=u("span"),S.textContent="FEES",E=d(),O=u("div"),j=d(),N=u("input"),B=d(),L=u("div"),M=d(),q=u("span"),U=f(ie),C=f("%"),P=d(),T=u("div"),I=d(),Y=u("div"),J=u("div"),R=u("div");for(let e=0;e<ae.length;e+=1)ae[e].c();K=d(),V=u("div"),X=d(),Z=u("div");for(let e=0;e<fe.length;e+=1)fe[e].c();ee=d(),te=u("div"),ne=u("div");for(let e=0;e<ce.length;e+=1)ce[e].c();$(h,"color",0===t[5]?"red":1===t[5]?"orange":"green"),m(n,"class","center-box svelte-io86af"),$(O,"width","1rem"),m(N,"type","number"),$(L,"width","1rem"),$(k,"display","flex"),$(k,"align-items","center"),m(x,"class","center-box svelte-io86af"),$(T,"height","4rem"),m(R,"class","select svelte-io86af"),$(V,"height","1rem"),m(Z,"class","select svelte-io86af"),$(J,"width","49vw"),$(ne,"display","flex"),$(ne,"flex-wrap","wrap"),$(te,"width","49vw"),$(Y,"width","98vw"),$(Y,"display","flex")},m(e,o){l(e,n,o),c(n,r),c(r,i),c(r,h),c(h,g),c(r,y),l(e,w,o),l(e,x,o),c(x,k),c(k,S),c(k,E),c(k,O),c(k,j),c(k,N),_(N,t[0]),c(k,B),c(k,L),c(k,M),c(k,q),c(q,U),c(q,C),l(e,P,o),l(e,T,o),l(e,I,o),l(e,Y,o),c(Y,J),c(J,R);for(let e=0;e<ae.length;e+=1)ae[e].m(R,null);c(J,K),c(J,V),c(J,X),c(J,Z);for(let e=0;e<fe.length;e+=1)fe[e].m(Z,null);c(Y,ee),c(Y,te),c(te,ne);for(let e=0;e<ce.length;e+=1)ce[e].m(ne,null);oe||(re=[p(N,"input",t[8]),p(N,"keyup",t[6])],oe=!0)},p(e,[t]){if(32&t&&$(h,"color",0===e[5]?"red":1===e[5]?"orange":"green"),1&t&&v(N.value)!==e[0]&&_(N,e[0]),1&t&&ie!==(ie=e[0]/1e4+"")&&b(U,ie),134&t){let n;for(se=e[2],n=0;n<se.length;n+=1){const o=D(e,se,n);ae[n]?ae[n].p(o,t):(ae[n]=G(o),ae[n].c(),ae[n].m(R,null))}for(;n<ae.length;n+=1)ae[n].d(1);ae.length=se.length}if(138&t){let n;for(ue=e[3],n=0;n<ue.length;n+=1){const o=W(e,ue,n);fe[n]?fe[n].p(o,t):(fe[n]=H(o),fe[n].c(),fe[n].m(Z,null))}for(;n<fe.length;n+=1)fe[n].d(1);fe.length=ue.length}16&t&&(de=e[4],ce=function(e,t,n,o,r,i,c,l,s,a,u,f){let d=e.length,h=i.length,p=d;const m={};for(;p--;)m[e[p].key]=p;const g=[],v=new Map,b=new Map;for(p=h;p--;){const e=f(r,i,p),l=n(e);let s=c.get(l);s?o&&s.p(e,t):(s=a(l,e),s.c()),v.set(l,g[p]=s),l in m&&b.set(l,Math.abs(p-m[l]))}const _=new Set,$=new Set;function y(e){F(e,1),e.m(l,u),c.set(e.key,e),u=e.first,h--}for(;d&&h;){const t=g[h-1],n=e[d-1],o=t.key,r=n.key;t===n?(u=t.first,d--,h--):v.has(r)?!c.has(o)||_.has(o)?y(t):$.has(r)?d--:b.get(o)>b.get(r)?($.add(o),y(t)):(_.add(r),d--):(s(n,c),d--)}for(;d--;){const t=e[d];v.has(t.key)||s(t,c)}for(;h;)y(g[h-1]);return g}(ce,t,he,1,e,de,le,ne,A,Q,null,z))},i:e,o:e,d(e){e&&s(n),e&&s(w),e&&s(x),e&&s(P),e&&s(T),e&&s(I),e&&s(Y),a(ae,e),a(fe,e);for(let e=0;e<ce.length;e+=1)ce[e].d();oe=!1,o(re)}}}function X(e,t,n){let o,r,i=1e3,c=[],l=[],s=[],a=[],u={},f={},d=[],h=0;function p(){o=new WebSocket("wss://stream.binance.com/stream"),o.onopen=()=>{n(5,h=2),r=setInterval(b,1e3),d.length>0&&o.send(R(d))},o.onmessage=e=>{const t=JSON.parse(e.data);if(null==t?void 0:t.data){const{s:e,a:n,b:o}=t.data;u[e]={BUY:n,SELL:o}}_()},o.onclose=()=>{n(5,h=0),clearInterval(r),setTimeout((()=>{n(5,h=1),p()}),1e3)}}function m(e){const t=[...new Set(e.flatMap((e=>e.pairs.map((e=>e.tickerName)))))];t.forEach((e=>{d.includes(e)||(o.send(R([e])),d=[...d,e])})),d.forEach((e=>{var n;t.includes(e)||(o.send((n=[e],JSON.stringify({method:"UNSUBSCRIBE",params:n,id:312}))),d=d.filter((t=>t!==e)))}))}function b(){n(4,a=a.sort(((e,t)=>t.percent-e.percent)))}function _(e=a){n(4,a=e.map(((e,t)=>n=>{const o=(t||0)/1e6,r=n.pairs.reduce(((t,n)=>{if("BUY"===n.side)return(t-t*o)/(e[n.id]?.BUY||0);const r=t*(e[n.id]?.SELL||1/0);return r-r*o}),1)-1;return{...n,percent:r/Math.abs(1)*100,isProfitable:r>0}})(u,i)))}x((()=>{J().then((e=>{f=e,n(2,l=Object.keys(e)),n(3,s=[...new Set(Object.values(e).flat(1))].filter((t=>!Object.keys(e).includes(t))))})),p()}));const $=[[]];return[i,c,l,s,a,h,_,function(){const e=(t=c,t.map((e=>t.map((n=>t.map((t=>e!==n&&e!==t&&n!==t?{path:[e,n,t],joined:`${e}/${n}/${t}`}:null)))))).flat(2).filter(Boolean).reduce(((e,t)=>{const{path:n}=t,o=e.map((e=>e.joined));return o.includes(n.join())||o.includes([n[1],n[2],n[0]].join())||o.includes([n[2],n[0],n[1]].join())||e.push(t),e}),[])).map(I(f)).filter((e=>e.pairs.every(Boolean)));var t;m(e),_(e)},function(){i=v(this.value),n(0,i)},function(){c=g($[0],this.__value,this.checked),n(1,c)},$,function(){c=g($[0],this.__value,this.checked),n(1,c)}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),T(this,e,X,V,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
